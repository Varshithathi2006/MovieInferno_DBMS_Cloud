"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[0],{7531:function(e,t,a){a.d(t,{u:function(){return m}});var r=a(7437),n=a(2265),o=a(3145),i=a(7648),c=a(1047),s=a(5275),l=a(1178),d=a(2869),u=a(6070),h=a(5953),g=a(3303),v=a(5561);function m(e){let{movie:t,className:a=""}=e,[m,f]=(0,n.useState)(null),{isInWatchlist:p,addToWatchlist:w,removeFromWatchlist:y,loading:x}=(0,v.B)(null==m?void 0:m.id),b=t.release_date?new Date(t.release_date).getFullYear():"TBA";t.vote_average&&t.vote_average.toFixed(1),(0,n.useEffect)(()=>{(async()=>{var e;let{data:{session:t}}=await g.O.auth.getSession();f(null!==(e=null==t?void 0:t.user)&&void 0!==e?e:null)})();let{data:{subscription:e}}=g.O.auth.onAuthStateChange((e,t)=>{var a;f(null!==(a=null==t?void 0:t.user)&&void 0!==a?a:null)});return()=>e.unsubscribe()},[]);let _=async e=>{if(e.preventDefault(),e.stopPropagation(),!m){alert("Please sign in to add items to your watchlist");return}p(t.id,"movie")?await y(t.id,"movie"):await w({tmdb_id:t.id,media_type:"movie",title:t.title,poster_path:t.poster_path,release_date:t.release_date,vote_average:t.vote_average||0,overview:t.overview})};return(0,r.jsx)(i.default,{href:"/movie/".concat(t.id),children:(0,r.jsx)(u.Zb,{className:"group cursor-pointer transition-all duration-300 hover:scale-105 hover:shadow-lg hover:shadow-accent/20 bg-card border-border ".concat(a),children:(0,r.jsxs)(u.aY,{className:"p-0",children:[(0,r.jsx)("div",{className:"relative aspect-[2/3] overflow-hidden rounded-t-lg",children:(0,r.jsx)(o.default,{src:(0,h.Jn)(t.poster_path)||"/placeholder.svg",alt:t.title||"Movie poster",fill:!0,className:"object-cover transition-transform duration-300 group-hover:scale-110",sizes:"(max-width: 768px) 50vw, (max-width: 1200px) 33vw, 25vw"})}),(0,r.jsxs)("div",{className:"p-4",children:[(0,r.jsx)("h3",{className:"font-semibold text-card-foreground line-clamp-2 text-balance mb-2 group-hover:text-accent transition-colors",children:t.title}),(0,r.jsxs)("div",{className:"flex items-center text-muted-foreground text-sm mb-3",children:[(0,r.jsx)(c.Z,{className:"w-4 h-4 mr-1"}),b]}),(0,r.jsx)(d.z,{onClick:_,disabled:x,variant:p(t.id,"movie")?"secondary":"default",className:"w-full border border-white ".concat((p(t.id,"movie"),"bg-red-600 hover:bg-red-700 text-white")),size:"sm",children:x?"Loading...":p(t.id,"movie")?(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(s.Z,{className:"w-4 h-4 mr-2"}),"In Watchlist"]}):(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(l.Z,{className:"w-4 h-4 mr-2"}),"Add to Watchlist"]})})]})]})})})}},6070:function(e,t,a){a.d(t,{Ol:function(){return i},SZ:function(){return s},Zb:function(){return o},aY:function(){return l},ll:function(){return c}});var r=a(7437);a(2265);var n=a(4508);function o(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card",className:(0,n.cn)("bg-card text-card-foreground flex flex-col gap-6 rounded-xl border py-6 shadow-sm",t),...a})}function i(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-header",className:(0,n.cn)("@container/card-header grid auto-rows-min grid-rows-[auto_auto] items-start gap-1.5 px-6 has-data-[slot=card-action]:grid-cols-[1fr_auto] [.border-b]:pb-6",t),...a})}function c(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-title",className:(0,n.cn)("leading-none font-semibold",t),...a})}function s(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-description",className:(0,n.cn)("text-muted-foreground text-sm",t),...a})}function l(e){let{className:t,...a}=e;return(0,r.jsx)("div",{"data-slot":"card-content",className:(0,n.cn)("px-6",t),...a})}},5561:function(e,t,a){a.d(t,{B:function(){return o}});var r=a(2265),n=a(3303);function o(e){let[t,a]=(0,r.useState)([]),[o,i]=(0,r.useState)(!0),[c,s]=(0,r.useState)(null),l=(0,r.useCallback)(async()=>{if(!e){a([]),i(!1);return}try{i(!0);let t=await fetch("/api/watchlist?user_id=".concat(e));if(!t.ok)throw Error("Failed to fetch watchlist");let r=await t.json();a(r),s(null)}catch(e){s("Failed to load watchlist"),console.error("Error fetching watchlist:",e)}finally{i(!1)}},[e]);(0,r.useEffect)(()=>{if(!e)return;l();let t=n.O.channel("watchlist_changes").on("postgres_changes",{event:"*",schema:"public",table:"watchlist",filter:"user_id=eq.".concat(e)},e=>{console.log("Watchlist change detected:",e),l()}).subscribe();return()=>{t.unsubscribe()}},[e,l]);let d=(0,r.useCallback)((e,a)=>t.some(t=>t.tmdb_id===e&&t.media_type===a),[t]);return{watchlistItems:t,isInWatchlist:d,addToWatchlist:(0,r.useCallback)(async t=>{if(!e)return!1;try{if(!(await fetch("/api/watchlist",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e,...t})})).ok)throw Error("Failed to add to watchlist");return await l(),!0}catch(e){return console.error("Error adding to watchlist:",e),s("Failed to add to watchlist"),!1}},[e,l]),removeFromWatchlist:(0,r.useCallback)(async(t,a)=>{if(!e)return!1;try{if(!(await fetch("/api/watchlist",{method:"DELETE",headers:{"Content-Type":"application/json"},body:JSON.stringify({user_id:e,tmdb_id:t,media_type:a})})).ok)throw Error("Failed to remove from watchlist");return await l(),!0}catch(e){return console.error("Error removing from watchlist:",e),s("Failed to remove from watchlist"),!1}},[e,l]),loading:o,error:c}}},5275:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("BookmarkCheck",[["path",{d:"m19 21-7-4-7 4V5a2 2 0 0 1 2-2h10a2 2 0 0 1 2 2Z",key:"169p4p"}],["path",{d:"m9 10 2 2 4-4",key:"1gnqz4"}]])},1047:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Calendar",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}]])},5135:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Github",[["path",{d:"M15 22v-4a4.8 4.8 0 0 0-1-3.5c3 0 6-2 6-5.5.08-1.25-.27-2.48-1-3.5.28-1.15.28-2.35 0-3.5 0 0-1 0-3 1.5-2.64-.5-5.36-.5-8 0C6 2 5 2 5 2c-.3 1.15-.3 2.35 0 3.5A5.403 5.403 0 0 0 4 9c0 3.5 3 5.5 6 5.5-.39.49-.68 1.05-.85 1.65-.17.6-.22 1.23-.15 1.85v4",key:"tonef"}],["path",{d:"M9 18c-4.51 2-5-2-7-2",key:"9comsn"}]])},7760:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Instagram",[["rect",{width:"20",height:"20",x:"2",y:"2",rx:"5",ry:"5",key:"2e1cvw"}],["path",{d:"M16 11.37A4 4 0 1 1 12.63 8 4 4 0 0 1 16 11.37z",key:"9exkf1"}],["line",{x1:"17.5",x2:"17.51",y1:"6.5",y2:"6.5",key:"r4j83e"}]])},2351:function(e,t,a){a.d(t,{Z:function(){return r}});let r=(0,a(9205).Z)("Twitter",[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]])},5953:function(e,t,a){a.d(t,{Jn:function(){return o},Wu:function(){return c},g$:function(){return l},ss:function(){return s},x3:function(){return d}});let r="df540dc7eced57f912edf1ef5c88ebda",n=new Map,o=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"w500";return e?"https://image.tmdb.org/t/p/".concat(t).concat(e):"/placeholder.svg"};async function i(e){if(!r)throw Error("TMDB API key not configured. Please add NEXT_PUBLIC_TMDB_API_KEY to your environment variables.");let t=n.get(e);if(t&&Date.now()-t.timestamp<3e5)return console.log("[API] Using cached data for:",e),t.data;let a="".concat("https://api.themoviedb.org/3").concat(e).concat(e.includes("?")?"&":"?","api_key=").concat(r);try{console.log("[API] Making request to:",e);let t=await fetch(a);if(!t.ok){if(401===t.status)throw Error("Invalid TMDB API key. Please check your NEXT_PUBLIC_TMDB_API_KEY environment variable.");if(404===t.status)throw Error("Resource not found");throw Error("API request failed: ".concat(t.status," ").concat(t.statusText))}let r=await t.json();return console.log("[API] Request successful for:",e),n.set(e,{data:r,timestamp:Date.now()}),r}catch(t){throw console.error("[API] Fetch error for",e,":",t),t}}let c={getTrending:()=>i("/trending/movie/week"),getPopular:()=>i("/movie/popular"),getTopRated:()=>i("/movie/top_rated"),getUpcoming:()=>i("/movie/upcoming"),getNowPlaying:()=>i("/movie/now_playing"),getDetails:e=>i("/movie/".concat(e)),getCredits:e=>i("/movie/".concat(e,"/credits")),getVideos:e=>i("/movie/".concat(e,"/videos")),getSimilar:e=>i("/movie/".concat(e,"/similar")),getRecommendations:e=>i("/movie/".concat(e,"/recommendations")),search:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return i("/search/movie?query=".concat(encodeURIComponent(e),"&page=").concat(t))}},s={getTrending:()=>i("/trending/tv/week"),getPopular:()=>i("/tv/popular"),getTopRated:()=>i("/tv/top_rated"),getAiringToday:()=>i("/tv/airing_today"),getOnTheAir:()=>i("/tv/on_the_air"),getDetails:e=>i("/tv/".concat(e)),getCredits:e=>i("/tv/".concat(e,"/credits")),getVideos:e=>i("/tv/".concat(e,"/videos")),getSimilar:e=>i("/tv/".concat(e,"/similar")),search:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return i("/search/tv?query=".concat(encodeURIComponent(e),"&page=").concat(t))}},l={getPopular:()=>i("/person/popular"),getDetails:e=>i("/person/".concat(e)),search:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return i("/search/person?query=".concat(encodeURIComponent(e),"&page=").concat(t))}},d={getMovieGenres:()=>i("/genre/movie/list"),getTVGenres:()=>i("/genre/tv/list"),getMoviesByGenre:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return i("/discover/movie?with_genres=".concat(e,"&page=").concat(t))},getTVByGenre:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;return i("/discover/tv?with_genres=".concat(e,"&page=").concat(t))}}}}]);